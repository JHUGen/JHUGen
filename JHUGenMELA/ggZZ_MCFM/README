#========================================================
# Instruction for using the JHUGenMELA/ggZZ_MCFM
# NOTE the instructions need lxplus at cern
# contact Yanyan Gao (Yanyan.Gao@cern.ch)
#========================================================

1. set up the enviorment in JHUGenMELA/ggZZ_MCFM/

* choose sl5 or sl6 by doing one of the following

source setup_matrixelement_sl5.sh # for sl5 machines
source setup_matrixelement_sl6.sh # for sl6 machines

2. Make the MCFM library outside of the JHUGenMELA/ggZZ_MCFM

   1) Download MCFM 
   
   cd ../
   wget http://mcfm.fnal.gov/mcfm-6.7.tar.gz
   tar -xf MCFM-6.7.tar.gz
   cd MCFM/

   2) Modify makefile: replace the gfortran code tags to output library

    FFLAGS 	= -fno-automatic -fno-f2c -O0 -fPIC -g -I$(INCPATH) -I$(TENSORREDDIR)/Include -Iobj
    F90FLAGS = -fno-automatic -fno-f2c -O2 -fPIC -g -I$(INCPATH) -Iobj -Jobj

   3) Modify the makefile in QCDLoop/ql and QCDLoop/ff, adding the -fPIC in FFLAGS

      FFLAGS  = -g -fPIC

   4) compile the package and export the libarry
   
    ./Install
    make
    cd obj/
    g++ -Wl,-soname,libmcfm_6p7.so -shared -o libmcfm_6p7.so *.o ../QCDLoop/ql/ql*.o ../QCDLoop/ql/a*.o ../QCDLoop/ff/*.o  

   5) copy library libmcfm_6p7.so to the JHUGenMELA/ggZZ_MCFM/ area


3. go back to JHUGenMELA/ggZZ_MCFM/ and compile the MELA code

make clean   # absolutely needed
make

4. run test script based on one event

root -l -b -q testME.C+

* The output is in "output.txt", which should be identical to the reference "output_ref.txt"
