%
%
\documentclass[aps,superscriptaddress,nofootinbib]{revtex4}
%\documentclass[12pt]{article}
\usepackage{graphicx}
\usepackage{epsfig}
\usepackage{float}
% % \usepackage{cprotect}
\usepackage{amsmath}

% \textwidth18cm
% \addtolength{\oddsidemargin}{-2cm}
% \addtolength{\evensidemargin}{-2cm}

\newcommand{\eg}{e.g.~}

\begin{document}

\vspace{0.6cm}

\title{
\large
Manual for the JHU generator
}
\maketitle
\begin{center}
\small
For simulation of a single-produced resonance at hadron colliders \\
(version v6.8.4, release date Jan. 07, 2016, manual date Jan. 07, 2016) \\
\normalsize
\end{center}

\noindent
The generator from \cite{Gao:2010qx,Bolognesi:2012,Anderson:2013} is a model-independent generator for studying spin and parity properties of new resonances.
Please cite \cite{Gao:2010qx,Bolognesi:2012,Anderson:2013} if using the "JHU generator".
The code can be downloaded from \cite{thesite}.
The generator outputs LHE files which can be passed to parton shower programs for hadronization.
Only relative values of cross sections are supposed to produce meaningful results, while absolute values are often subject to an arbitrary normalization.

Additionally, the package includes code for computing the matrix elements standalone which can be used in a numerical matrix element analysis.
Please reference the above papers and refer to "MELA" when using the matrix element likelihood analysis technique.
The latter was also introduced in Ref.~\cite{Chatrchyan:2012ufa}. The matrix element package (MELA) also depends
on MCFM libraries for background parameterization which should be referenced~\cite{Campbell:2010ff} when used.

\vspace{0.5cm}
\begin{center}
\line(1,0){250}
\end{center}
\vspace{0.5cm}
\tableofcontents
\begin{center}
%\line(1,0){250}
\end{center}
\vspace{0.5cm}

%\newpage

\section{ Installation }

\noindent
Register and download the package from \verb|www.pha.jhu.edu/spin| and untar the file.  Go to the directory \verb|JHUGenerator| where the code exists for generating events with the JHU Generator. In the \verb|makefile|, you have two options for compiler, \verb|Comp = ifort| or \verb|Comp = gfort|.  Then simply compile with:
\begin{verbatim}
$ make
\end{verbatim}

\section{ Configuration }

There are two ways to configure the program, from the command line and in the file \verb|mod_Parameters.F90|.  For documentation from the command line, one can use \verb|JHUGen help|.  In addition, the command line configurables are defined in the file \verb|main.F90|.  When one change the fortran code directly, one should also recompile the code for changes to take effect.  In general, command-line configuration handles general event properties while the configuration file handles all of the couplings and physics handles.

\subsection{ Command line configuration }

The list of command line configurables and the default values are (also defined in the \verb|README|):

\begin{verbatim}
    Collider:          1=LHC, 2=Tevatron, 0=e+e-
    Process:           0=spin-0, 1=spin-1, 2=spin-2 resonance, 50=pp/ee->VH,
                       60=weakVBF, 61=pp->Hjj, 62=pp->Hj, 80=ttH, 90=bbH,
                       110=t+H t channel, 111=tbar+H t channel,
                       112=t+H s channel, 113=tbar+H s channel
    MReso:             resonance mass in GeV (default=125.00)
    GaReso:            resonance width in GeV (default=0.00407)
    DecayMode1:        decay mode for vector boson 1 (Z/W/gamma)
    DecayMode2:        decay mode for vector boson 2 (Z/W/gamma)
                         0=Z->2l,  1=Z->2q, 2=Z->2tau, 3=Z->2nu,
                         4=W->lnu, 5=W->2q, 6=W->taunu,
                         7=gamma, 8=Z->2l+2tau,
                         9=Z->anything, 10=W->lnu+taunu, 11=W->anything
    PChannel:          0=g+g, 1=q+qb, 2=both
    OffXVV:            off-shell option for resonance(X),or vector bosons(VV)
    PDFSet:            1=CTEQ6L1(2001),  2=MSTW(2008),
                                         2xx=MSTW with eigenvector set xx=01..40,
                                         3=NNPDF3.0LO
    VegasNc0:          number of evaluations for integrand scan
    VegasNc1:          number of evaluations for accept-reject sampling
    VegasNc2:          number of events for accept-reject sampling
    Unweighted:        0=weighted events, 1=unweighted events
    Interf:            0=neglect interference for 4f final states,
                       1=include interference
    DataFile:          LHE output file
    ReadLHE:           LHE input file from external file (only spin-0)
    ConvertLHE:        Convert decay of the V from VH production.
                       Use DecayMode1 to specify the decay.
                       (should be a Z or W mode, depending on the input file)
    TopDK:             For ttH or t+H, 0=leave top quarks as stable, 1=decay top quarks
    FilterNLept:       For decay mode, reject events that have less than FilterNLept leptons
    FilterOSPairs:     For decay mode, reject events that have less than FilterOSPairs pairs of
                         sign leptons of any flavor.
    FilterOSSFPairs:   For decay mode, reject events that have less than FilterOSSFPairs pairs of
                         opposite-sign-same-flavor leptons.
    CountTauAsAny:     For FilterOSSFPairs, taus can stand in place of electrons or muons
                         of the same charge.
    LHAPDF:            PDF set to use if interfaced with LHAPDF. See below.
    FacScheme:         PDF factorization scale scheme
    MuFacMultiplier:   Multiplier for the factorization scale chosen by FacScheme
    RenScheme:         QCD renormalization scale scheme
    MuRenMultiplier:   Multiplier for the renormalization scale chosen by RenScheme
    WidthScheme:       Higgs width scheme: 0 for fixed width (default), 1 for running width,
                         and 2 for the CPS
    WriteFailedEvents: Write events that fail in the LHE file, but with a weight of 0
                         (off by default)
    pTjetcut:          Minimum pT for jets in GeV (default: 15)
    deltaRcut:         Minimum deltaR for jets (default: 0.3)
    mJJcut:            Minimum dijet mass in GeV (default: 0)
    ghz1, ghz2, ghz4,
          ghz1_prime2: Spin 0 ZZ anomalous couplings
    ghg2, ghg4:        Spin 0 gg anomalous couplings
    a1,a2,b1,b2,b5:    Spin 2 anomalous couplings
\end{verbatim}

\noindent
A few more details on some particular parameters:

\begin{itemize}
\item {\verb|VegasNc0,1,2|}: For unweighted event generation \verb|VegasNc0| specifies the number of evaluations for the initial integrand scan.  The actual event generation is controlled by either \verb|VegasNc1| or \verb|VegasNc2|. \verb|VegasNc1| specifies the number of tries in the accept/reject phase and \verb|VegasNc2| is the number of generated events. When generating unweighted events in \verb|ReadLHE| mode, both \verb|VegasNc1| or \verb|VegasNc2| can be used to specify the number of generated events. For the generation of weighted events \verb|VegasNc1| specifies the number of evaluations for each of 5 iterations during the initial integrand scan. \verb|VegasNc2| gives the (approximate) number of generated weighted events.
\item {\verb|OffXVV|}: The program does not work for $ZZ$ or $WW$ if you set them to be on-shell (\verb|OffXVV="000"|) and the mass of the $X$ resonance to be below the $m_{VV}$ threshold.  In general, the more off-shell the process, or the more "1" you have, the less efficient the \verb|VegasNc1| evaluations are.  Specifically, if you are interested then, in producing a resonance with mass below threshold $m_{VV}$ with a very narrow resonance, it is most efficient to generate with \verb|OffXVV="011"|
\item \verb|PChannel|: This parameter is only meaningful in the spin-2 case and for the $ttH$ and $bbH$ production mechanisms.  For spin-0, production is possible only via the $gg$ process; for spin-1 and for the VBF and $VH$ processes, production is only possible via the $q\bar{q}$ process.  For $H+jj$ and $H+j$, all four parton channels $gg$, $q\bar{q}$, $qg$, and $\bar{q}g$ are included.
\item \verb|DecayMode1,2=7|: Valid for spin-0 and spin-2.  Only OffXVV=000 or 100 are possible.
\item In $VH$ production and \verb|ConvertLHE| mode, \verb|DecayMode1| is used for the decay of the $V$.  If it is a $Z$ decay mode, $ZH$ will be produced; if it is a $W$ decay mode, $WH$ will be produced.
\item In $ttH$ production, \verb|DecayMode1| and \verb|DecayMode2| are used to decay the $W$ bosons from the top decay.  Only $W$ decay modes are allowed.
\item In $t+H$ production, \verb|DecayMode1| is used to decay the W boson from the top decay.
\item \verb|Interf|: For final states with 4 same flavor fermions, this parameter controls whether or not to include interference effects.
\item \verb|FacScheme|, \verb|MuFacMultiplier|, and \verb|RenScheme|, \verb|MuRenMultiplier|: There are currently 10 different schemes, which set the basis of the scale up to the scale multiplier. A postive integer uses running scales per event whereas a negative one uses a fixed scale, and \verb|MuFacMultiplier| and \verb|MuRenMultiplier| determine the scale multipliers for the factorization and renormalization scales, respectively:
     \begin{itemize}
     \item $\pm0$: $\mu_{F,\,R}$ are set to the default values of each process. The command line values of \verb|MuFacMultiplier| and \verb|MuRenMultiplier| are disregarded.
     \item $\pm1$: $\mu_{F,\,R} \propto \sqrt{q^2_H}$ if the scheme number is positive, or $\mu_{F,\,R} \propto m_H$ if the scheme number is negative. $+1$ is the default value for \verb|Process| 0, 1 and 2 with scale multiplier $0.5$, and  $-1$ is the default value for \verb|Process| 50, 60, 61 and 62 with scale multiplier $1$.
     \item $\pm2$: If the scheme number is positive, $\mu_{F,\,R} \propto \sqrt{q^2_{JJH}}$, where $J$ refers to a particle (partons or leptons) immediately associated in the Higgs production. If the scheme number is negative and the Higgs and the associated partons originate from a common particle (\eg $V^{*}$ in $VH$), $\mu_{F,\,R} \propto m_{JJH}$.
     \item $\pm3$: If the scheme number is positive, $\mu_{F,\,R} \propto \sqrt{q^2_{JJ}}+\sqrt{q^2_{H}}$. If the scheme number is negative and the associated particles originate from a common particle without the Higgs (\eg $V$ in $VH$), $\mu_{F,\,R} \propto m_{JJ}+m_{H}$.
     \item $\pm4$: If the scheme number is positive, $\mu_{F,\,R} \propto \sqrt{q^2_{J1}}+\sqrt{q^2_{J2}}+\sqrt{q^2_{H}}$, where $J_{1,\,2}$ are the associated particles. If the scheme number is negative and the matrix element treats the associated particles as massive (\eg $t$ and $\bar{t}$ in $t\bar{t}H$), $\mu_{F,\,R} \propto m_{J1}+m_{J2}+m_{H}$.  $-4$ is the default value for \verb|Process| 80 and 90 with scale multiplier $0.5$.
     \item $\pm5$: If the scheme number is positive, $\mu_{F,\,R} \propto \sqrt{q^2_{JJ}}$. If the scheme number is negative and the associated particles originate from a common particle without the Higgs (\eg $V$ in $VH$), $\mu_{F,\,R} \propto m_{JJ}$.
     \item $\pm6$: If the scheme number is positive, $\mu_{F,\,R} \propto \sqrt{q^2_{J1}}+\sqrt{q^2_{J2}}$, where $J_{1,\,2}$ are the associated particles. If the scheme number is negative and the matrix element treats the associated particles as massive (\eg $t$ and $\bar{t}$ in $t\bar{t}H$), $\mu_{F,\,R} \propto m_{J1}+m_{J2}$.
     \item $\pm7$: If the scheme number is positive, $\mu_{F,\,R} \propto \sqrt{q^2_{JH}}$, where $J$ is the more massive associated particle by its pole mass. If the scheme number is negative and the matrix element treats an associated particle as massive (\eg $t$ in $t+H$), $\mu_{F,\,R} \propto m_{J}+m_{H}$ for the most massive associated particle.
     \item $\pm8$: If the scheme number is positive, $\mu_{F,\,R} \propto \sqrt{q^2_{J}}+\sqrt{q^2_{H}}$, where $J$ is the more massive associated particle. If the scheme number is negative and the matrix element treats an associated particle as massive (\eg $t$ in $t+H$), $\mu_{F,\,R} \propto m_{J}+m_{H}$ for the most massive associated particle (same as option -7).  $-8$ is the default value for \verb|Process| 110, 111, 112 and 113. with scale multiplier $0.25$.
     \item $\pm9$: If the scheme number is positive, $\mu_{F,\,R} \propto \sqrt{q^2_{J}}$, where $J$ is the more massive associated particle. If the scheme number is negative and the matrix element treats an associated particle as massive (\eg $t$ in $t+H$), $\mu_{F,\,R} \propto m_{J}$.
     \end{itemize}
\item \verb|WidthScheme|: This option controls the width scheme in JHUGen. The options are 0 for fixed width, 1 for running width, and 2 for the complex pole scheme~\cite{Passarino:2010qk,Goria:2011wa}. 0 is the default option.
\item \verb|WriteFailedEvents|: In \verb|ReadLHE| mode, events that fail in decay or that fail the lepton filter are by default not written to the LHE file.  If this option is set to 1, they are written, but their weight is set to 0.  If it is set to 2, they are written with a weight of zero and with no particles in the event.  This option is useful if the same number of events are required to be in the input and the output.
\item \verb|pTjetcut|, \verb|deltaRcut|, \verb|mJJcut| All three cuts are used in processes 60 (VBF), 61 ($H+jj$), 90 ($bbH$), and also 80 ($ttH$) if \verb|m_Top| is set to be light ($<10 \text{GeV}$).  In addition, \verb|pTjetcut| is used in process 62 ($H+j$) and also processes 110--113 ($t/\bar{t}+H$) if \verb|m_Top| is light.
\item Anomalous couplings: the most commonly used anomalous couplings can be set on the command line.  These are:
\begin{itemize}
\item \verb|ghz1|, \verb|ghz2|, \verb|ghz4|, and \verb|ghz1_prime2| for spin 0 $ZZ$ couplings
\item \verb|ghg2| and \verb|ghg4| for spin 0 $gg$ couplings
\item \verb|a1|, \verb|a2|, \verb|b1|, \verb|b2|, and \verb|b5| for spin 2.
\end{itemize}
The couplings can be set either as:
\begin{itemize}
\item \verb|ghz4=1,0|, specifying the real and imaginary parts together
\item \verb|Reghz4=1 Imghz4=0|, specifying the real and imaginary parts separately.
\end{itemize}
If any anomalous couplings are set, the default couplings (\verb|ghz1| for spin 0 $ZZ$, \verb|ghg2| for spin 0 $gg$, \verb|a2| and \verb|b2| for spin 2) must also be explicitly turned off by setting them to 0 or explicitly turned on by setting them to nonzero values.
\end{itemize}

Examples of running the generator:
\begin{itemize}
\item $gg$ production:
\begin{verbatim}
./JHUGen Collider=1 Process=0 VegasNc2=100000 PChannel=0 OffXVV=011 DecayMode1=0 \\
		DecayMode2=0 Unweighted=1 DataFile=ggHZZ4l
\end{verbatim}
\item $gg$ production, pseudoscalar resonance:
\begin{verbatim}
./JHUGen Collider=1 Process=0 VegasNc2=100000 PChannel=0 OffXVV=011 DecayMode1=0 \\
		DecayMode2=0 Unweighted=1 DataFile=ggHZZ4l_0- ghz1=0,0 ghz4=1,0
\end{verbatim}
\item $ggH \to Z\gamma$
\begin{verbatim}
./JHUGen DecayMode1=0 DecayMode2=7 OffXVV=010 DataFile=ggHgammaZ2l
\end{verbatim}
\item $ZH$ with hadronic $Z$ decay (change \verb|DecayMode1| for other $Z$ decays; both $pp$ and $e^+e^-$ Collider options possible):
\begin{verbatim}
./JHUGen Collider=1 Process=50 DecayMode1=1 Unweighted=1 VegasNc2=100000 \\
		OffXVV=011 DataFile=ZH
\end{verbatim}
\item $WH$ with leptonic $W$ decay (change \verb|DecayMode1| for other $W$ decays):
\begin{verbatim}
./JHUGen Collider=1 Process=50 DecayMode1=4 Unweighted=1 VegasNc2=100000 \\
		OffXVV=011 DataFile=WH
\end{verbatim}
\item VBF:
\begin{verbatim}
./JHUGen Collider=1 Process=60 Unweighted=1 VegasNc2=100000 OffXVV=011 DataFile=VBF \\
		pTjetcut=0 deltaRcut=0
\end{verbatim}
(Jet cuts are generally not needed for VBF production, since there is no divergence.)
\item $H+jj$:
\begin{verbatim}
./JHUGen Collider=1 Process=61 Unweighted=1 VegasNc2=100000 OffXVV=011 DataFile=Hjj
\end{verbatim}
\item $H+j$:
\begin{verbatim}
./JHUGen Collider=1 Process=62 Unweighted=1 VegasNc2=100000 OffXVV=011 DataFile=Hj
\end{verbatim}
\item $pp \to t\bar{t}+H$ with inclusive top decay (change \verb|DecayMode1,2| for specific $tt$ decays):
\begin{verbatim}
./JHUGen Collider=1 Process=80 DecayMode1=11 DecayMode2=11 Unweighted=1 \\
		VegasNc2=100000 OffXVV=011 DataFile=ttH
\end{verbatim}
\item $pp \to b\bar{b}+H$:
\begin{verbatim}
./JHUGen Collider=1 Process=90 Unweighted=1 VegasNc2=100000 OffXVV=011 DataFile=bbH
\end{verbatim}
\item $pp \to t+H$, $t$ channel with inclusive top decay (change \verb|DecayMode1| for specific $t$ decays; similar syntax for processes 111--113):
\begin{verbatim}
./JHUGen Collider=1 Process=110 DecayMode1=11 Unweighted=1 \\
		VegasNc2=100000 OffXVV=011 DataFile=tH_s
\end{verbatim}
\end{itemize}

%\begin{center}
%\line(1,0){250}
%\end{center}
%\noindent
%\footnotesize
%{\it N.B.}
%There is a beta-version of the generator which has improved efficiency for the generation.  However, it is currently only available for gluon-gluon initiated processes.
%It is by default turned off, but it can be accessed in the file \verb|main.F90|.  The beta version is currently still under validation.
%\begin{verbatim}
%logical,parameter :: useBetaVersion=.false.
%\end{verbatim}
%\normalsize
%\begin{center}
%\line(1,0){250}
%\end{center}

\noindent
For generating Higgs decay in VBF, $H+j(j)$, $VH$, $ttbH$, or $tH$ production
modes by the JHU generator or NLO gluon fusion with another generator (e.g. POWHEG), use JHU generator in \verb|ReadLHE|
mode and specify the decay mode of interest ($ZZ$, $WW$, $\gamma\gamma$, $Z\gamma$), while the SM fermionic decays
may be generated by Pythia without loss of generality.

\subsection{ Configuration in parameter file  }

In the file \verb|mod_Parameters.F90|, one does all the configuration of the couplings of the resonance.
After modifying this file, one needs to recompile.

\subsubsection{ General parameters }

\begin{itemize}
\item Switches:
\begin{itemize}
\item
Each generation run is different when this is \verb|.true.|

\begin{verbatim}
seed_random = .true.
\end{verbatim}

\begin{itemize}
\item
If \verb|seed_random| is false, the seeds are set through
\begin{verbatim}
integer, public :: TheSeeds(0:20)
\end{verbatim}
\end{itemize}

\item
In the case when \verb|PChannel=2| for a spin-2 resonance, the user can define an approximate ratio of the production of gg and $q\bar{q}$ production.

\begin{verbatim}
fix_channels_ratio = .true.
channels_ratio_fix = 0.25d0    ! desired ratio of N_qq/(N_qq+N_gg)
\end{verbatim}


\item
For final states with a Z-boson decaying into $f\bar f$, intermediate off-shell photons can be included by switching
\begin{verbatim}
logical, public, parameter :: includeGammaStar = .false.
\end{verbatim}
to the value \verb|.true.|.
\begin{itemize}
\item
In such case, a lower cut on the photon invariant mass has to be placed in order to athe collinear singularity. This cutoff parameter is controlled by
\begin{verbatim}
real(8),parameter :: MPhotonCutoff = 4d0*GeV.
\end{verbatim}
\end{itemize}

\item
For $VV$ decay (and similarly in $ttH$ production), by default the $V$'s are randomized so that, for example, \verb|DecayMode1=5 DecayMode2=11| will produce all combinations that include at least one hadronic $W$ decay (rather of specifically hadronic decay of the $W^+$).  This can be switched off by changing
\begin{verbatim}
logical, public, parameter :: RandomizeVV = .true.
\end{verbatim}
to \verb|.false.|.  In this case, \verb|DecayMode1| will refer specifically to the $W^+$ and \verb|DecayMode2| to the $W^-$.  For $ZZ$ decay, this parameter only determines whether the decays of first and second $Z$ written to the LHE file are randomized or not; in this case the only effect is the appearance of the output.

\item
When reading in LHE files, JHUGen determines the format by looking at the first lines of the first event.  If this determination fails for any reason (for example, if different events are written in inconsistent formats), try changing
\begin{verbatim}
+logical, public, parameter :: UseUnformattedRead = .false.
\end{verbatim}
to \verb|.true.|.  However, this will noticeably slow down event generation in \verb|ReadLHE| mode.



\item
For the generation of weighted events (command line \verb|Unweighted=0|) an LHE output file is created if
\begin{verbatim}
logical, public, parameter :: writeWeightedLHE = .false.
\end{verbatim}
is set to \verb|.true.|.
\end{itemize}

\item
Jet cuts, as described above, which should generally be set by command line options.

\item Constants, more or less self-explanatory, including the masses of particles and width of Standard Model particles and the generated resonance, CKM matrix elements, $Z$ and $W$ branching fractions and scale factors for NLO QCD corrections ($1+\alpha_s/\pi$), and collider energies.  They are documented in comments in \verb|mod_Parameters.F90|.

\item Resonance couplings to SM fields, described in detail in the next few sections
\end{itemize}

\subsubsection{ Spin-0 parameters }

\noindent
The \verb|*hg*| parameters control the coupling of a spin-0 resonance to gluons in the production mechanism.
In practice, the production parameters do not have a large effect since angular corrections from the production mechanism are lost for spinless particles.
The \verb|*hz*| parameters control the decay into $Z$ and $W$ bosons.
One has the options to set the spin-0 couplings either from Eq.(9) or Eq.(11) from Ref.~\cite{Bolognesi:2012}.
To switch between the two, use the parameter \verb|generate_as|.
%For the parameters in Eq.(9) from Ref.~\cite{Bolognesi:2012}, we now allow for $q^2$ dependent form factors as described in Eq.(3) of~\cite{Anderson:2013} as:
We allow for $q^2$ dependent form factors similar to those described in Ref.~\cite{Anderson:2013}:
\begin{eqnarray*}
g^\Lambda_i(q_1,q_2) &=& 
g_i' \frac{\Lambda_i^4}{(\Lambda_i^2 + |q_1^2|)(\Lambda_i^2 + |q_2^2|)} \\
&+& g_i^{\prime 2}  \frac{(q_1^2+q_2^2)}{\Lambda_i^2} 
+ g_i^{\prime 3}  \frac{(q_1^2-q_2^2)}{\Lambda_i^2} 
+ g_i^{\prime 4}  \frac{(q_1+q_2)^2}{\Lambda_Q^2} \\
&+& g_i^{\prime 5}  \frac{((q_1^2)^2+(q_2^2)^2)}{\Lambda_i^4}  
+ g_i^{\prime 6}  \frac{((q_1^2)^2-(q_2^2)^2)}{\Lambda_i^4}
+ g_i^{\prime 7}  \frac{q_1^2 \, q_2^2}{\Lambda_i^4} \\
g_i(q_1,q_2) &=& g_i \delta_{i1} + (g^\Lambda_i (q_1,q_2) + g_i (1- \delta_{i1}))
\frac{\Lambda^2_{i1}\,\Lambda^2_{i2}\,\Lambda^2_{i3}}
{(\Lambda^2_{i1}+c_{i1}|q_1|^2)\,(\Lambda^2_{i2}+c_{i2}|q_2|^2)\,(\Lambda^2_{i3}+c_{i3}|q_1+q_2|^2)}
\noindent
\end{eqnarray*}
The user has the option to choose between these functional forms,
where the term multiplying $g_i'$ corresponds to the full functional form and the $g_i''... g_i'''''' $ correspond to an expansion in $\Lambda^2$.
All parameters can be modified in \verb|mod_Parameters.F90| by:
\begin{verbatim}

!-- parameters that define on-shell spin 0 coupling to SM fields, see note
   logical, public, parameter :: generate_as = .false.
   complex(8), public, parameter :: ahg1 = (1.0d0,0d0)
   complex(8), public, parameter :: ahg2 = (0.0d0,0d0)
   complex(8), public, parameter :: ahg3 = (0.0d0,0d0)  ! pseudoscalar
   complex(8), public, parameter :: ahz1 = (1.0d0,0d0)
   complex(8), public, parameter :: ahz2 = (0.0d0,0d0)  ! this coupling does not contribute for
                                                        ! gamma+gamma final states
   complex(8), public, parameter :: ahz3 = (0.0d0,0d0)  ! pseudoscalar

!-- parameters that define off-shell spin 0 coupling to SM fields, see note
   complex(8), public, parameter :: ghg2 = (1.0d0,0d0)
   complex(8), public, parameter :: ghg3 = (0.0d0,0d0)
   complex(8), public, parameter :: ghg4 = (0.0d0,0d0)   ! pseudoscalar
   complex(8), public, parameter :: ghz1 = (2.0d0,0d0)
   complex(8), public, parameter :: ghz2 = (0.0d0,0d0)
   complex(8), public, parameter :: ghz3 = (0.0d0,0d0)
   complex(8), public, parameter :: ghz4 = (0.0d0,0d0)   ! pseudoscalar

!-- parameters that define q^2 dependent form factors
   complex(8), public, parameter :: ghz1_prime = (0.0d0,0d0)
   complex(8), public, parameter :: ghz1_prime2= (0.0d0,0d0)
   complex(8), public, parameter :: ghz1_prime3= (0.0d0,0d0)
   complex(8), public, parameter :: ghz1_prime4= (0.0d0,0d0)
   complex(8), public, parameter :: ghz1_prime5= (0.0d0,0d0)
   complex(8), public, parameter :: ghz1_prime6= (0.0d0,0d0)
   complex(8), public, parameter :: ghz1_prime7= (0.0d0,0d0)

   complex(8), public, parameter :: ghz2_prime = (0.0d0,0d0)
   complex(8), public, parameter :: ghz2_prime2= (0.0d0,0d0)
   complex(8), public, parameter :: ghz2_prime3= (0.0d0,0d0)
   complex(8), public, parameter :: ghz2_prime4= (0.0d0,0d0)
   complex(8), public, parameter :: ghz2_prime5= (0.0d0,0d0)
   complex(8), public, parameter :: ghz2_prime6= (0.0d0,0d0)
   complex(8), public, parameter :: ghz2_prime7= (0.0d0,0d0)

   complex(8), public, parameter :: ghz3_prime = (0.0d0,0d0)
   complex(8), public, parameter :: ghz3_prime2= (0.0d0,0d0)
   complex(8), public, parameter :: ghz3_prime3= (0.0d0,0d0)
   complex(8), public, parameter :: ghz3_prime4= (0.0d0,0d0)
   complex(8), public, parameter :: ghz3_prime5= (0.0d0,0d0)
   complex(8), public, parameter :: ghz3_prime6= (0.0d0,0d0)
   complex(8), public, parameter :: ghz3_prime7= (0.0d0,0d0)

   complex(8), public, parameter :: ghz4_prime = (0.0d0,0d0)
   complex(8), public, parameter :: ghz4_prime2= (0.0d0,0d0)
   complex(8), public, parameter :: ghz4_prime3= (0.0d0,0d0)
   complex(8), public, parameter :: ghz4_prime4= (0.0d0,0d0)
   complex(8), public, parameter :: ghz4_prime5= (0.0d0,0d0)
   complex(8), public, parameter :: ghz4_prime6= (0.0d0,0d0)
   complex(8), public, parameter :: ghz4_prime7= (0.0d0,0d0)

   real(8),    public, parameter :: Lambda_z1 = 10000d0*GeV
   real(8),    public, parameter :: Lambda_z2 = 10000d0*GeV
   real(8),    public, parameter :: Lambda_z3 = 10000d0*GeV
   real(8),    public, parameter :: Lambda_z4 = 10000d0*GeV
   real(8),    public, parameter :: Lambda_Q  = 10000d0*GeV
   
   integer,    public, parameter :: cz_q1sq = 0d0 ! Sign of q1,2,12**2 for the following Lambda's
   integer,    public, parameter :: cz_q2sq = 0d0
   integer,    public, parameter :: cz_q12sq = 0d0
   
   real(8),    public, parameter :: Lambda_z11 = 100d0*GeV ! For Z1
   real(8),    public, parameter :: Lambda_z21 = 100d0*GeV
   real(8),    public, parameter :: Lambda_z31 = 100d0*GeV
   real(8),    public, parameter :: Lambda_z41 = 100d0*GeV
   real(8),    public, parameter :: Lambda_z12 = 100d0*GeV ! For Z2
   real(8),    public, parameter :: Lambda_z22 = 100d0*GeV
   real(8),    public, parameter :: Lambda_z32 = 100d0*GeV
   real(8),    public, parameter :: Lambda_z42 = 100d0*GeV
   real(8),    public, parameter :: Lambda_z10 = 100d0*GeV ! For the Higgs
   real(8),    public, parameter :: Lambda_z20 = 100d0*GeV
   real(8),    public, parameter :: Lambda_z30 = 100d0*GeV
   real(8),    public, parameter :: Lambda_z40 = 100d0*GeV         
\end{verbatim}

If the switch \verb|includeGammaStar| is set to \verb|.true.| then intermediate off-shell photons are included for $Z$ boson final states.
Their couplings to the spin-0 resonance are controlled by separate parameters,
\begin{verbatim}
   complex(8), public, parameter :: ghzgs2  = (0.00d0,0d0)
   complex(8), public, parameter :: ghzgs3  = (0.00d0,0d0)
   complex(8), public, parameter :: ghzgs4  = (0.00d0,0d0)
   complex(8), public, parameter :: ghgsgs2 = (0.00d0,0d0)
   complex(8), public, parameter :: ghgsgs3 = (0.00d0,0d0)
   complex(8), public, parameter :: ghgsgs4 = (0.00d0,0d0)
\end{verbatim}
where the first three correspond to $Z\gamma^*$ couplings and the latter three corresponds to $\gamma^* \gamma^*$ interactions.
These two sets of parameters also control the coupling strength in final states with on-shell photons, i.e. $Z\gamma$ and $\gamma\gamma$.
The anomalous coupling involving the off-shell photon momentum (in $\gamma^* Z$ interactions)
\[
g_1' \frac{ q^2_\gamma }{ \Lambda_2^{Z\gamma} } m_Z^2 \epsilon^*_1 \epsilon^*_2
\]
is set by
\begin{verbatim}
   complex(8), public, parameter :: ghzgs1_prime2= (0.0d0,0d0)
   real(8),    public, parameter :: Lambda_zgs1 = 10000d0*GeV.
\end{verbatim}

In the weak vector boson fusion process (VBF) we also allow for different $ZZH$ and $WWH$ couplings.
Per default, they are assumed to be equal, set by 
\begin{verbatim}
   logical, public, parameter :: distinguish_HWWcouplings=.false.
\end{verbatim}
If this value is set to \verb|.true.|, their value will be used instead for the $WWH$ interactions. Each \verb|Lambda_z|
and \verb|cz_q1sq| parameter has a \verb|Lambda_w| and \verb|cw_q1sq| counterpart.



\subsubsection{ Spin-1 parameters }

The parameters below represent the couplings given in Eq.~(16) from Ref.~\cite{Bolognesi:2012}. The \verb|*left*| and \verb|*right*| parameters control the production of the spin-1 resonance while the \verb|*_v| and \verb|*_a| parameters control the decay.

\begin{verbatim}
!---parameters that define spin 1 coupling to SM fields, see note
   complex(8), public, parameter :: zprime_qq_left  = (1.0d0,0d0)   !  see note Eq. (4)
   complex(8), public, parameter :: zprime_qq_right = (0.0d0,0d0)
   complex(8), public, parameter :: zprime_zz_v =  (1.0d0,0d0)!  =1 for JP=1-
   complex(8), public, parameter :: zprime_zz_a =  (0.0d0,0d0)!  =1 for JP=1+
\end{verbatim}

\subsubsection{ Spin-2 parameters }

\noindent
The \verb|a*| parameters control the coupling of a spin-2 resonance to gluons in the production mechanism.  The \verb|b*| and \verb|c*| parameters control the decay.
One has the options to set the spin-2 couplings either from Eq.(18) or Eq.(19) from Ref.~\cite{Bolognesi:2012}.  To switch between the two, use the parameter \verb|generate_bis|.

\begin{verbatim}
  logical, public, parameter :: generate_bis = .true.
  logical, public, parameter :: use_dynamic_MG = .true. ! .true. (=default),
													    ! the spin-2 resonance mass with MG^2=(p1+p2)^2, otherwise fixed at M_Reso^2.

  complex(8), public, parameter :: a1 = (1.0d0,0d0)    ! g1  -- c.f. note
  complex(8), public, parameter :: a2 = (0.0d0,0d0)    ! g2
  complex(8), public, parameter :: a3 = (0.0d0,0d0)    ! g3
  complex(8), public, parameter :: a4 = (0.0d0,0d0)    ! g4
  complex(8), public, parameter :: a5 = (0.0d0,0d0)    ! pseudoscalar, g8

  complex(8), public, parameter :: graviton_qq_left  = (1.0d0,0d0)! graviton coupling to quarks
  complex(8), public, parameter :: graviton_qq_right = (1.0d0,0d0)

  complex(8), public, parameter :: b1 = (1.0d0,0d0)
  complex(8), public, parameter :: b2 = (0.0d0,0d0)
  complex(8), public, parameter :: b3 = (0.0d0,0d0)
  complex(8), public, parameter :: b4 = (0.0d0,0d0)
  complex(8), public, parameter :: b5 = (0.0d0,0d0)
  complex(8), public, parameter :: b6 = (0.0d0,0d0)
  complex(8), public, parameter :: b7 = (0.0d0,0d0)
  complex(8), public, parameter :: b8 = (0.0d0,0d0)
  complex(8), public, parameter :: b9 = (0.0d0,0d0)
  complex(8), public, parameter :: b10 =(0.0d0,0d0)


  complex(8), public, parameter  :: c1 = (1.0d0,0d0)
  complex(8), public, parameter  :: c2 = (0.0d0,0d0)
  complex(8), public, parameter  :: c3 = (0.0d0,0d0)
  complex(8), public, parameter  :: c41= (0.0d0,0d0)
  complex(8), public, parameter  :: c42= (0.0d0,0d0)
  complex(8), public, parameter  :: c5 = (0.0d0,0d0)
  complex(8), public, parameter  :: c6 = (0.0d0,0d0)
  complex(8), public, parameter  :: c7 = (0.0d0,0d0)
\end{verbatim}

\section{ Examples }

\noindent
The below examples are not meant to be a complete set, but rather some interesting and relevant cases.
In many cases, the example is not the only way to produce such a scenario.

\subsection{ $J^P = 0^+_m$ resonance, $X \to ZZ~{\rm or}~WW$}
\label{sec:exA}

\begin{verbatim}
   logical, public, parameter :: generate_as = .true.

   complex(8), public, parameter :: ahg1 = (1.0d0,0d0)
   complex(8), public, parameter :: ahg2 = (0.0d0,0d0)
   complex(8), public, parameter :: ahg3 = (0.0d0,0d0)  ! pseudoscalar
   complex(8), public, parameter :: ahz1 = (1.0d0,0d0)
   complex(8), public, parameter :: ahz2 = (0.0d0,0d0)
   complex(8), public, parameter :: ahz3 = (0.0d0,0d0)  ! pseudoscalar
\end{verbatim}

\subsection{ $J^P = 0^-_m$ resonance, $X \to ZZ~{\rm or}~WW$}
\label{sec:exB}

\begin{verbatim}
   logical, public, parameter :: generate_as = .true.

   complex(8), public, parameter :: ahg1 = (1.0d0,0d0)
   complex(8), public, parameter :: ahg2 = (0.0d0,0d0)
   complex(8), public, parameter :: ahg3 = (0.0d0,0d0)  ! pseudoscalar
   complex(8), public, parameter :: ahz1 = (0.0d0,0d0)
   complex(8), public, parameter :: ahz2 = (0.0d0,0d0)
   complex(8), public, parameter :: ahz3 = (1.0d0,0d0)  ! pseudoscalar
\end{verbatim}

\subsection{ $J^P = 0^+_m$ resonance, $X \to \gamma \gamma$}
\label{sec:exC}

In practice, the example $X \to \gamma \gamma$ from this section, Sec.~\ref{sec:exC} and the next Sec.~\ref{sec:exD} are
kinematically the same but are presented only to illustrate how one takes care of this final state.

\begin{verbatim}
   logical, public, parameter :: generate_as = .false.

   complex(8), public, parameter :: ghg2 = (1.0d0,0d0)
   complex(8), public, parameter :: ghg3 = (0.0d0,0d0)
   complex(8), public, parameter :: ghg4 = (0.0d0,0d0)   ! pseudoscalar
   complex(8), public, parameter :: ghgsgs2 = (1.0d0,0d0)
   complex(8), public, parameter :: ghgsgs3 = (0.0d0,0d0)
   complex(8), public, parameter :: ghgsgs4 = (0.0d0,0d0)   ! pseudoscalar
\end{verbatim}

\subsection{ $J^P = 0^-_m$ resonance, $X \to \gamma \gamma$}
\label{sec:exD}

\begin{verbatim}
   logical, public, parameter :: generate_as = .false.

   complex(8), public, parameter :: ghg2 = (1.0d0,0d0)
   complex(8), public, parameter :: ghg3 = (0.0d0,0d0)
   complex(8), public, parameter :: ghg4 = (0.0d0,0d0)   ! pseudoscalar
   complex(8), public, parameter :: ghgsgs2 = (1.0d0,0d0)
   complex(8), public, parameter :: ghgsgs3 = (0.0d0,0d0)
   complex(8), public, parameter :: ghgsgs4 = (0.0d0,0d0)   ! pseudoscalar
\end{verbatim}

\subsection{ $J^P = 2^+_m$ resonance, $X \to ZZ~{\rm or}~WW~{\rm or}~\gamma \gamma$}

\begin{verbatim}

  complex(8), public, parameter :: a1 = (1.0d0,0d0)    ! g1  -- c.f. draft
  complex(8), public, parameter :: a2 = (0.0d0,0d0)    ! g2
  complex(8), public, parameter :: a3 = (0.0d0,0d0)    ! g3
  complex(8), public, parameter :: a4 = (0.0d0,0d0)    ! g4
  complex(8), public, parameter :: a5 = (0.0d0,0d0)    ! pseudoscalar, g8
  complex(8), public, parameter :: graviton_qq_left  = (1.0d0,0d0)! graviton coupling to quarks
  complex(8), public, parameter :: graviton_qq_right = (1.0d0,0d0)

  logical, public, parameter :: generate_bis = .true.
  logical, public, parameter :: use_dynamic_MG = .true.

  complex(8), public, parameter :: b1 = (1.0d0,0d0)
  complex(8), public, parameter :: b2 = (0.0d0,0d0)
  complex(8), public, parameter :: b3 = (0.0d0,0d0)
  complex(8), public, parameter :: b4 = (0.0d0,0d0)
  complex(8), public, parameter :: b5 = (1.0d0,0d0)
  complex(8), public, parameter :: b6 = (0.0d0,0d0)
  complex(8), public, parameter :: b7 = (0.0d0,0d0)
  complex(8), public, parameter :: b8 = (0.0d0,0d0)
  complex(8), public, parameter :: b9 = (0.0d0,0d0)
  complex(8), public, parameter :: b10 =(0.0d0,0d0)

\end{verbatim}

\subsection{Cross-section calculation and fraction notation}

For a vector boson coupling, we can represent the four independent parameters by two  fractions
($f_{g2}$ and $f_{g4}$) and two phases ($\phi_{g2}$ and $\phi_{g4}$), defined for the $HZZ$
and $HWW$ couplings as follows (ignoring $g_3$)
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%
\begin{eqnarray}
&& f_{gi} =  \frac{|g^{}_{i}|^2\sigma_i}{|g^{}_{1}|^2\sigma_1+|g^{}_{2}|^2\sigma_2+|g^{}_{4}|^2\sigma_4}\,;
~~~~~~~~~
 \phi_{gi} = \arg\left(\frac{g_i}{g_1}\right)\,.
\nonumber
\label{eq:fractions}
\end{eqnarray}
%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
In order to obtain the cross-sections $\sigma_i$ corresponding to the $g^{}_{i}=1$ coupling,
generate large enough (e.g. VegasNc1=1000000, VegasNc2=50000000) number of weighted
({\tt Unweighted=0}) with the corresponding couplings setup ($g^{}_{i}=1$, $g^{}_{j\ne i}=0$).

\subsection{LHAPDF}

It is possible to interface to an LHAPDF setup instead of compiling with local PDF's.  To accomplish this:

\begin{itemize}
\item In the makefile:
\begin{itemize}
\item Set UseLHAPDF=Yes
\item Set MyLHADir to a directory with your LHAPDF setup.  This can be in terms of environment variables; for example \verb|MyLHADir=${LHAPDF_DATA_PATH}/../../lib/|.
\end{itemize}
\item Ensure that \verb|$LHAPDF_DATA_PATH| and \verb|$LD_LIBRARY_PATH| are set (both when compiling and when running).
\item Compile
\item Run with the extra command line parameter \verb|LHAPDF| specifying your PDF set's \verb|.info| file.  For example: \verb|LHAPDF=NNPDF30_lo_as_0130/NNPDF30_lo_as_0130.info|
\end{itemize}


%%%%%%%%%%%
\section{ JHU Generator Matrix Elements (JHUGenMELA)}

After extracting the code, you can go to the directory \verb|JHUGenMELA| to find code for computing matrix elements directly.
To compile the code, simply run \texttt{make}.

\textbf{Please take note: The setup is configured for \texttt{gfort + gcc version 4.1.2 20080704 (Red Hat 4.1.2-50)} and it is highly dependent on the compiler version.  Please configure for your own setup accordingly.}  (Using the \verb|nm| command will help decipher the module names you will need)

Instructions for setting up the JHUGenMELA with MCFM are in the file \verb|JHUGenMELA/ggZZ_MCFM/README|. This \verb|C++| interface also covers the native matrix elements aforementioned through the wrapper class \verb|TEvtProb|. The class currently includes the following calls:
\begin{itemize}
\item \verb|TEvtProb|: Constructor with argument $\sqrt{s}$ in units of GeV.
\item \verb|SetProcess|: Set the process to be used in te calculation of the ME
\item \verb|SetMatrixElement|: Set the matrix element (Analytical, MCFM or JHUGen)
\item \verb|SetProduction|: Set the production (as enumerated in the TVar class)
\item \verb|SetLeptonInterf|: Set whether lepton interference is included in decay MEs. By default, it is included for JHUGen decay MEs or MCFM $q\bar{q}$ background MEs. It is not included in the other MCFM MEs.

\item \verb|ResetMCFM_EWKParameters|: Reset the MCFM EWK scheme and its parameters. See MCFM manual for the details on the EWK scheme.

\item \verb|Set_LHAgrid|: One-time call to setup the PDF path in case NNPDF 3.0 is used.

\item \verb|XsecCalc|: Calls to the decay MEs are handled through this function. Depending on the type of process, the self-defined coupling arrays may be ignored. Uses the following interfaced fortran subroutines:
\begin{itemize}
\item "modhiggs\_\_evalamp\_gg\_h\_vv": Spin-0 matrix elements for $gg$ initiated processes
\item "modzprime\_\_evalamp\_qqb\_zprime\_vv": Spin-1 matrix elements for $q\bar{q}$ initiated processes
\item "modzprime\_\_evalamp\_zprime\_vv": Spin-1 matrix elements production-independent
\item "modgraviton\_\_evalamp\_qqb\_g\_vv": Spin-2 matrix elements for $q\bar{q}$ initiated processes
\item "modgraviton\_\_evalamp\_gg\_g\_vv:" Spin-2 matrix elements for $gg$ initiated processes
\item "modgraviton\_\_evalamp\_g\_vv": Spin-2 matrix elements production-independent
\end{itemize}

\item \verb|XsecCalcXJJ|: Calls to VBF, and $Hjj$ MEs are handled from this function. Depending on the production mode or the process, these arrays may be ignored.
\begin{itemize}
\item "modhiggsjj\_\_evalamp\_wbfh": Spin-0 matrix element for on-shell $VBF$ production
\item "modhiggsjj\_\_evalamp\_sbfh": Spin-0 matrix element for on-shell $H+JJ$ QCD production
\end{itemize}

\item \verb|XsecCalcXJ|: Call to the JHUGen $Hj$ ME is handled through tis routine.
\begin{itemize}
\item "modhiggsj\_\_evalamp\_hj": Spin-0 matrix element for on-shell $H+J$ QCD production
\end{itemize}

\item \verb|XsecCalc_VX|: Call to the JHUGen $VH$ ME is handled from this routine.
\begin{itemize}
\item "modvhiggs\_\_evalamp\_vhiggs": Spin-0 matrix element for on-shell $VH$ production
\end{itemize}

\item \verb|XsecCalc_TTX|: Call to te $t\bar{t}H$ ME is handled through this routine.
\begin{itemize}
\item "modttbhiggs\_\_evalxsec\_pp\_ttbh": Spin-0 matrix element for on-shell $t\bar{t}H$ production
\item "modttbhiggs\_\_evalxsec\_pp\_bbbh": Spin-0 matrix element for on-shell $b\bar{b}H$ production
\end{itemize}

\item \verb|SetHiggsMass|: This routine changes the Higgs mass and width used in the MCFM calculations.

\end{itemize}

The inputs are usually the 4-vectors of the incoming patrons and outgoing particles in the CM frame of the object $X$.
In addition the mass and width of the resonance are required as well as the ID of the outgoing particles.
Finally the last set of inputs are the couplings themselves.  They are arrays for parameters for a given spin hypothesis
which mirror the parameters configurable in \verb|mod_Parameters.F90|.
Exemplary array initialization can be found in \verb|testprogram.c| for the native matrix elements or \verb|testME.C| for the interface with MCFM.
For the interface, you can also see the beginning declarations in \verb|TVar.hh| for the list of enumerated variables, and \verb|testME.C| for example calls (eg. array filling, assignment of momenta, and passing te arguments to these routines).

%%%%%%%%%%%

\section{ Release notes }

\noindent
In going from \verb|v6.8.4| to \verb|v6.8.5|, the updates are as follows:

\begin{itemize}
\item Resonance width, jet cuts, and some anomalous couplings are now command line parameters
\end{itemize}

\noindent
In going from \verb|v6.7.8| to \verb|v6.8.4|, the updates are as follows:

\begin{itemize}
\item Added running renormalization scale and generalized the running scales
\item Added more options for the Higgs mass shape
\item Improved LHE reading and writing
\end{itemize}

\noindent
In going from \verb|v6.2.8| to \verb|v6.7.8|, the updates are as follows:

\begin{itemize}
\item Added running factorization scale ($\mu_F=m_{H*}/2$) in spin-0,1,2 decays
\item Enabled identical 4$\nu$ and 4$q$ final state interference in $ZZ$ decay
\item Faster VBF and $Hjj$ event generation with deterministic jet flavor assignment
\item $VH$ code clean-up
\item Update of the CKM matrix and of hadronic $W$ decay
\item New processes \verb|110-113| for $t/\bar{t}+H$ production
\item More flexible lepton filter
\end{itemize}

\noindent
In going from \verb|v5.6.3| to \verb|v6.2.8|, the updates are as follows:

\begin{itemize}
\item Flexible LHE reading process for compatibility with more generators
\item Small bugfixes
\end{itemize}

\noindent
In going from \verb|v5.2.5| to \verb|v5.6.3|, the updates are as follows:

\begin{itemize}
\item Add \verb|Process=90| for $bbH$ production
\item Add lepton filtering option
\item Allow $W$ from $ttH$ to decay to any decay mode
\item Allow $W$ to decay to off-diagonal elements of the CKM matrix
\item Add support for LHAPDF linking
\item Fixes for LHE printout in $VBF$, $Hjj$, and $VH$
\end{itemize}

\noindent
In going from \verb|v4.8.1| to \verb|v5.2.5|, the updates are as follows:

\begin{itemize}
\item Add \verb|Process=80| for $ttH$ production, with optional top decays
\item Add support for NNPDF
\item Make $\verb|DecayMode1|\ne\verb|DecayMode2|$ equivalent to generating everything and then filtering
\item Add option for randomizing the $V$'s in $HVV$ decays
\item Fixes for smoother reading of LHE files: mother assignment and invariant mass for all intermediate particles
\item Add \verb|ConvertLHE| option for converting VH decay to any DecayMode
\item In \verb|ReadLHE| and \verb|ConvertLHE|, preserve comments and optional tags from the input LHE
\end{itemize}

\noindent
In going from \verb|v4.5.2| to \verb|v4.8.1|, the updates are as follows:

\begin{itemize}
\item More flexibility for $q^2$-dependent form factors
\item Separate couplings for ZZH and WWH in weak boson fusion
\item Add new process: $pp\to H$+jet (Process=62)
\item Extended LHE output format to allow for more digits
\item MCFM plug-in for anomalous couplings in off-shell Higgs boson production in gg->ZZ
\item Synchronize JHUGenMELA with MCFM library v6.8
\item JHUGenMELA: extended MCFM ggHZZ matrix elements by anomalous couplings
\item JHUGenMELA: add matrix elements for H+jet and V+H
\end{itemize}


\noindent
In going from \verb|v4.3.2| to \verb|v4.5.2|, the updates are as follows:

\begin{itemize}
\item Add an option of intermediate photons for the modes with Z-bosons
\item More flexibility for $q^2$-dependent form factors
\item Option of hadronic branching rescaling (NLO QCD corrections) for inclusive decays
\item Synchronize JHUGenMELA with the generator and with MCFM library v6.7
\end{itemize}

\noindent
In going from \verb|v4.2.1| to \verb|v4.3.2|, the updates are as follows:

\begin{itemize}
\item Update LHE file format and index of partons
\item Improve log printout
\item Update ReadLHE mode: $H\to Z\gamma$ output and more flexible input
\item $VH$ production (replaces beta version)
\item More flexibility for $q^2$-dependent form factors
\item Tune $q^2$-dependence of couplings for some of the spin-$2_h$ models
\item Synchronize JHUGenMELA with the generator
\end{itemize}

\noindent
In going from \verb|v4.0.x| to \verb|v4.2.x|, the updates are as follows:

To JHUGenerator:
\begin{itemize}
\item Fix BR in "all" decay mode
\item Updates to LHE output
\item Option to print out CS\_max, output for g' and Lambdas
\item Introduction of AnalyticMELA for $ee \to ZH$ and $pp \to ZH$ and analytic parton distribution functions
\end{itemize}


\noindent
In going from \verb|v3.1.x| to \verb|v4.0.x|, the updates are as follows:

To JHUGenerator:
\begin{itemize}
\item Addition of VBF and Hjj process channels
\item Possibility to read in VBF LHE event files
\end{itemize}

To JHUGenMELA:
\begin{itemize}
\item Interface with the MCFM program for ggZZ process
\item Matrix elements for VBF and Hjj processes
\end{itemize}


\noindent
In going from \verb|v2.2.6| to \verb|v3.1.8|, the updates are as follows:

To \verb|JHUGenerator|:
\begin{itemize}
\item Capability reading LHE files with Higgs boson production, allows NLO production of spin-0;
\item Extended the list of final state combinations;
\item Log messages, lhe file headers, and minor cleanup.
\item Updates to deal with non-zero lepton masses, lhe file format, and adjust default settings (e.g. lepton interference applied by default and can be configured in command line)
\end{itemize}

To \verb|JHUGenMELA|:
\begin{itemize}
\item Production-independent JHUGenMELA for spin-0, 1, 2;
\item Complex couplings in JHUGenMELA input.
\end{itemize}

\noindent
In going from \verb|v2.2.3| to \verb|v2.2.6|, the updates are as follows:
\begin{itemize}
\item A small fix which corrects the {\it relative fraction} between the $2e2\mu$ and $4e$/$4\mu$ channels when using interference
\item beta version is still under development
\item $q\bar{q} \to$ spin-2 production is more safely performed with settings \verb|PChannel = 2| and $q\bar{q}$ fraction = 1.
\end{itemize}

\noindent
In going from \verb|v2.1.3| to \verb|v2.2.3|, the updates are as follows:
\begin{itemize}
\item Fix interference and randomization in the {\it{beta}} version
\item Add the \verb|JHUGenMELA| modules
\item Small change for compilation on Mac OSX platforms
\item Fix for tau masses in $W$ decays
\end{itemize}

\noindent
In going from \verb|v2.0.2| to \verb|v2.1.x|, the updates are as follows:

\begin{itemize}
\item Histograms are written in file (default: ./data/output.dat) and no longer on the screen.  How to understand the histogram data and how to plot is briefly described in the output.dat file.
\item Added tau masses
\item Added lepton interference in the ZZ4l final state
\item Added switch \verb|generate_as| to choose couplings in spin-0 case (works for on- and off-shell resonance). The default is ".false.".
\item Added the possibility to change graviton-quark couplings. The new parameters are \verb|graviton_qq_left|, \verb|graviton_qq_right| and correspond to $0.5*(1-\gamma^5)$ and $0.5*(1+\gamma^5)$ helicity projectors, respectively. Up to now the coupling was always vector-like. This is also the new default, \verb|graviton_qq_left = graviton_qq_right =1|.
\item The random seed is now fixed with gfortran.
\item The call "./JHUGen help" prints out all available command line options
\item Added new command line option "Unweighted=0 or 1" (default is 1)
\end{itemize}

\clearpage
\appendix

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\section{Specific configurations}

We define configurations for certain models which are defined in Table~1 of~\cite{Bolognesi:2012}.

%%%-------- 0+
\subsection{"SM-like spin-zero", $0^+$}

\footnotesize
\begin{verbatim}
!-- parameters that define on-shell spin 0 coupling to SM fields, see note
   logical, public, parameter :: generate_as = .false.
   complex(8), public, parameter :: ahg1 = (1.0d0,0d0)
   complex(8), public, parameter :: ahg2 = (0.0d0,0d0)
   complex(8), public, parameter :: ahg3 = (0.0d0,0d0)  ! pseudoscalar
   complex(8), public, parameter :: ahz1 = (1.0d0,0d0)
   complex(8), public, parameter :: ahz2 = (0.0d0,0d0)  ! this coupling does not contribute for gamma+gamma final states
   complex(8), public, parameter :: ahz3 = (0.0d0,0d0)  ! pseudoscalar

!-- parameters that define off-shell spin 0 coupling to SM fields, see note
   complex(8), public, parameter :: ghg2 = (1.0d0,0d0)
   complex(8), public, parameter :: ghg3 = (0.0d0,0d0)
   complex(8), public, parameter :: ghg4 = (0.0d0,0d0)   ! pseudoscalar
   complex(8), public, parameter :: ghz1 = (1.0d0,0d0)
   complex(8), public, parameter :: ghz2 = (0.0d0,0d0)
   complex(8), public, parameter :: ghz3 = (0.0d0,0d0)
   complex(8), public, parameter :: ghz4 = (0.0d0,0d0)   ! pseudoscalar
\end{verbatim}
\normalsize

%%%-------- 0+h
\subsection{"Higher order spin-zero", $0_h^+$}

\footnotesize
\begin{verbatim}
!-- parameters that define on-shell spin 0 coupling to SM fields, see note
   logical, public, parameter :: generate_as = .false.
   complex(8), public, parameter :: ahg1 = (1.0d0,0d0)
   complex(8), public, parameter :: ahg2 = (0.0d0,0d0)
   complex(8), public, parameter :: ahg3 = (0.0d0,0d0)  ! pseudoscalar
   complex(8), public, parameter :: ahz1 = (1.0d0,0d0)
   complex(8), public, parameter :: ahz2 = (0.0d0,0d0)  ! this coupling does not contribute for gamma+gamma final states
   complex(8), public, parameter :: ahz3 = (0.0d0,0d0)  ! pseudoscalar

!-- parameters that define off-shell spin 0 coupling to SM fields, see note
   complex(8), public, parameter :: ghg2 = (1.0d0,0d0)
   complex(8), public, parameter :: ghg3 = (0.0d0,0d0)
   complex(8), public, parameter :: ghg4 = (0.0d0,0d0)   ! pseudoscalar
   complex(8), public, parameter :: ghz1 = (0.0d0,0d0)
   complex(8), public, parameter :: ghz2 = (1.0d0,0d0)
   complex(8), public, parameter :: ghz3 = (0.0d0,0d0)
   complex(8), public, parameter :: ghz4 = (0.0d0,0d0)   ! pseudoscalar
\end{verbatim}
\normalsize

%%%-------- 0-
\subsection{"Pseudoscalar spin-zero", $0^-$}

\footnotesize
\begin{verbatim}
!-- parameters that define on-shell spin 0 coupling to SM fields, see note
   logical, public, parameter :: generate_as = .false.
   complex(8), public, parameter :: ahg1 = (1.0d0,0d0)
   complex(8), public, parameter :: ahg2 = (0.0d0,0d0)
   complex(8), public, parameter :: ahg3 = (0.0d0,0d0)  ! pseudoscalar
   complex(8), public, parameter :: ahz1 = (1.0d0,0d0)
   complex(8), public, parameter :: ahz2 = (0.0d0,0d0)  ! this coupling does not contribute for gamma+gamma final states
   complex(8), public, parameter :: ahz3 = (0.0d0,0d0)  ! pseudoscalar

!-- parameters that define off-shell spin 0 coupling to SM fields, see note
   complex(8), public, parameter :: ghg2 = (0.0d0,0d0)
   complex(8), public, parameter :: ghg3 = (0.0d0,0d0)
   complex(8), public, parameter :: ghg4 = (1.0d0,0d0)   ! pseudoscalar
   complex(8), public, parameter :: ghz1 = (0.0d0,0d0)
   complex(8), public, parameter :: ghz2 = (0.0d0,0d0)
   complex(8), public, parameter :: ghz3 = (0.0d0,0d0)
   complex(8), public, parameter :: ghz4 = (1.0d0,0d0)   ! pseudoscalar
\end{verbatim}
\normalsize

%%%-------- 1-
\subsection{"Vector spin-one", $1^-$}

\footnotesize
\begin{verbatim}
!---parameters that define spin 1 coupling to SM fields, see note
   complex(8), public, parameter :: zprime_qq_left  = (1.0d0,0d0)
   complex(8), public, parameter :: zprime_qq_right = (0.0d0,0d0)
   complex(8), public, parameter :: zprime_zz_v =  (1.0d0,0d0)!  =1 for JP=1-
   complex(8), public, parameter :: zprime_zz_a =  (0.0d0,0d0)!  =1 for JP=1+
\end{verbatim}
\normalsize

%%%-------- 1+
\subsection{"Pseudovector spin-one", $1^+$}

\footnotesize
\begin{verbatim}
!---parameters that define spin 1 coupling to SM fields, see note
   complex(8), public, parameter :: zprime_qq_left  = (1.0d0,0d0)
   complex(8), public, parameter :: zprime_qq_right = (0.0d0,0d0)
   complex(8), public, parameter :: zprime_zz_v =  (0.0d0,0d0)!  =1 for JP=1-
   complex(8), public, parameter :: zprime_zz_a =  (1.0d0,0d0)!  =1 for JP=1+
\end{verbatim}
\normalsize

%%%-------- 2+
\subsection{"Minimal Graviton, spin-two", $2^+$}

N.B. If an exclusive production mode is desired (e.g. $q\bar{q}$ or $gg$), this is handled at command-line configuration level via the \verb|PChannel| variable.

\footnotesize
\begin{verbatim}
!-- parameters that define spin 2 coupling to SM fields, see note
! minimal coupling corresponds to a1 = b1 = b5 = 1 everything else 0
  complex(8), public, parameter :: a1 = (1.0d0,0d0)    ! g1  -- c.f. draft
  complex(8), public, parameter :: a2 = (0.0d0,0d0)    ! g2
  complex(8), public, parameter :: a3 = (0.0d0,0d0)    ! g3
  complex(8), public, parameter :: a4 = (0.0d0,0d0)    ! g4
  complex(8), public, parameter :: a5 = (0.0d0,0d0)    ! pseudoscalar, g8
  complex(8), public, parameter :: graviton_qq_left  = (1.0d0,0d0)! graviton coupling to quarks
  complex(8), public, parameter :: graviton_qq_right = (1.0d0,0d0)

!-- see mod_Graviton
  logical, public, parameter :: generate_bis = .true.
  logical, public, parameter :: use_dynamic_MG = .true.

  complex(8), public, parameter :: b1 = (1.0d0,0d0)    !  all b' below are g's in the draft
  complex(8), public, parameter :: b2 = (0.0d0,0d0)
  complex(8), public, parameter :: b3 = (0.0d0,0d0)
  complex(8), public, parameter :: b4 = (0.0d0,0d0)
  complex(8), public, parameter :: b5 = (1.0d0,0d0)
  complex(8), public, parameter :: b6 = (0.0d0,0d0)
  complex(8), public, parameter :: b7 = (0.0d0,0d0)
  complex(8), public, parameter :: b8 = (0.0d0,0d0)
  complex(8), public, parameter :: b9 = (0.0d0,0d0)
  complex(8), public, parameter :: b10 =(0.0d0,0d0)  ! this coupling does not contribute for gamma+gamma final states


  complex(8), public, parameter  :: c1 = (1.0d0,0d0)
  complex(8), public, parameter  :: c2 = (0.0d0,0d0)
  complex(8), public, parameter  :: c3 = (0.0d0,0d0)
  complex(8), public, parameter  :: c41= (0.0d0,0d0)
  complex(8), public, parameter  :: c42= (0.0d0,0d0)
  complex(8), public, parameter  :: c5 = (0.0d0,0d0)
  complex(8), public, parameter  :: c6 = (0.0d0,0d0)
  complex(8), public, parameter  :: c7 = (0.0d0,0d0)
\end{verbatim}
\normalsize

%%%-------- 2+h
\subsection{"Higher order Graviton, spin-two", $2^+_h$}

\footnotesize
\begin{verbatim}
!-- parameters that define spin 2 coupling to SM fields, see note
! minimal coupling corresponds to a1 = b1 = b5 = 1 everything else 0
  complex(8), public, parameter :: a1 = (0.0d0,0d0)    ! g1  -- c.f. draft
  complex(8), public, parameter :: a2 = (0.0d0,0d0)    ! g2
  complex(8), public, parameter :: a3 = (0.0d0,0d0)    ! g3
  complex(8), public, parameter :: a4 = (1.0d0,0d0)    ! g4
  complex(8), public, parameter :: a5 = (0.0d0,0d0)    ! pseudoscalar, g8
  complex(8), public, parameter :: graviton_qq_left  = (1.0d0,0d0)! graviton coupling to quarks
  complex(8), public, parameter :: graviton_qq_right = (1.0d0,0d0)

!-- see mod_Graviton
  logical, public, parameter :: generate_bis = .true.
  logical, public, parameter :: use_dynamic_MG = .true.

  complex(8), public, parameter :: b1 = (0.0d0,0d0)    !  all b' below are g's in the draft
  complex(8), public, parameter :: b2 = (0.0d0,0d0)
  complex(8), public, parameter :: b3 = (0.0d0,0d0)
  complex(8), public, parameter :: b4 = (1.0d0,0d0)
  complex(8), public, parameter :: b5 = (0.0d0,0d0)
  complex(8), public, parameter :: b6 = (0.0d0,0d0)
  complex(8), public, parameter :: b7 = (0.0d0,0d0)
  complex(8), public, parameter :: b8 = (0.0d0,0d0)
  complex(8), public, parameter :: b9 = (0.0d0,0d0)
  complex(8), public, parameter :: b10 =(0.0d0,0d0)  ! this coupling does not contribute for gamma+gamma final states


  complex(8), public, parameter  :: c1 = (1.0d0,0d0)
  complex(8), public, parameter  :: c2 = (0.0d0,0d0)
  complex(8), public, parameter  :: c3 = (0.0d0,0d0)
  complex(8), public, parameter  :: c41= (0.0d0,0d0)
  complex(8), public, parameter  :: c42= (0.0d0,0d0)
  complex(8), public, parameter  :: c5 = (0.0d0,0d0)
  complex(8), public, parameter  :: c6 = (0.0d0,0d0)
  complex(8), public, parameter  :: c7 = (0.0d0,0d0)
\end{verbatim}
\normalsize

%%%-------- 2-h
\subsection{"Higher order Graviton, spin-two", $2^-_h$}

\footnotesize
\begin{verbatim}
!-- parameters that define spin 2 coupling to SM fields, see note
! minimal coupling corresponds to a1 = b1 = b5 = 1 everything else 0
  complex(8), public, parameter :: a1 = (0.0d0,0d0)    ! g1  -- c.f. draft
  complex(8), public, parameter :: a2 = (0.0d0,0d0)    ! g2
  complex(8), public, parameter :: a3 = (0.0d0,0d0)    ! g3
  complex(8), public, parameter :: a4 = (0.0d0,0d0)    ! g4
  complex(8), public, parameter :: a5 = (1.0d0,0d0)    ! pseudoscalar, g8
  complex(8), public, parameter :: graviton_qq_left  = (1.0d0,0d0)! graviton coupling to quarks
  complex(8), public, parameter :: graviton_qq_right = (1.0d0,0d0)

!-- see mod_Graviton
  logical, public, parameter :: generate_bis = .true.
  logical, public, parameter :: use_dynamic_MG = .true.

  complex(8), public, parameter :: b1 = (0.0d0,0d0)    !  all b' below are g's in the draft
  complex(8), public, parameter :: b2 = (0.0d0,0d0)
  complex(8), public, parameter :: b3 = (0.0d0,0d0)
  complex(8), public, parameter :: b4 = (0.0d0,0d0)
  complex(8), public, parameter :: b5 = (0.0d0,0d0)
  complex(8), public, parameter :: b6 = (0.0d0,0d0)
  complex(8), public, parameter :: b7 = (0.0d0,0d0)
  complex(8), public, parameter :: b8 = (1.0d0,0d0)
  complex(8), public, parameter :: b9 = (0.0d0,0d0)
  complex(8), public, parameter :: b10 =(0.0d0,0d0)  ! this coupling does not contribute for gamma+gamma final states


  complex(8), public, parameter  :: c1 = (1.0d0,0d0)
  complex(8), public, parameter  :: c2 = (0.0d0,0d0)
  complex(8), public, parameter  :: c3 = (0.0d0,0d0)
  complex(8), public, parameter  :: c41= (0.0d0,0d0)
  complex(8), public, parameter  :: c42= (0.0d0,0d0)
  complex(8), public, parameter  :: c5 = (0.0d0,0d0)
  complex(8), public, parameter  :: c6 = (0.0d0,0d0)
  complex(8), public, parameter  :: c7 = (0.0d0,0d0)
\end{verbatim}
\normalsize


\begin{thebibliography}{99}
\bibitem{Gao:2010qx}
Y.Y. Gao, A. V. Gritsan, Z.J. Guo, K. Melnikov, M. Schulze and N. V. Tran, "Spin-Determination of Single-Produced Resonances at Hadron Colliders". Phys. Rev. D {\bf 81}, 075022 (2010). arXiv:1001.3396 [hep-ph].
\bibitem{Bolognesi:2012}
S. Bolognesi, Y.Y. Gao, A. V. Gritsan, K. Melnikov, M. Schulze, N. V. Tran and A. Whitbeck, "On the Spin and Parity of Single-Produced Resonance at the LHC". Phys. Rev. D {\bf 86}, 095031 (2012). arXiv:1208.4018 [hep-ph].
\bibitem{Anderson:2013}
I. Anderson, S. Bolognesi, F. Caola, Y.Y. Gao, A. V. Gritsan, C. B. Martin, K. Melnikov, M. Schulze, N. V. Tran, A. Whitbeck, Y. Zhou, "Constraining anomalous HVV interactions at proton and lepton colliders". Phys. Rev. D {\bf 89}, 035007 (2014). arXiv:1309.4819 [hep-ph].
\bibitem{thesite}
See webpage: www.pha.jhu.edu/spin
\bibitem{Chatrchyan:2012ufa}
  S.~Chatrchyan {\it et al.}  [CMS Collaboration],
  ``Observation of a new boson at a mass of 125 GeV with the CMS experiment at the LHC,''
  Phys.\ Lett.\ B {\bf 716}, 30 (2012)
  [arXiv:1207.7235 [hep-ex]].
\bibitem{Campbell:2010ff}
  J.~M.~Campbell and R.~K.~Ellis,
  ``MCFM for the Tevatron and the LHC,''
  Nucl.\ Phys.\ Proc.\ Suppl.\  {\bf 205-206}, 10 (2010)
  [arXiv:1007.3492 [hep-ph]].
  See also http://mcfm.fnal.gov
\bibitem{Goria:2011wa}
  S.~Goria, G.~Passarino and D.~Rosco,
  ``The Higgs-boson lineshape,''
  Nucl.\ Phys.\ B  {\bf 864} (2012)
  [arXiv:1112.5517 [hep-ph]].
\bibitem{Passarino:2010qk}
  G.~Passarino, C.~Sturm and S.~Uccirati, 
  ``Higgs pseudo-observables, second riemann sheet and all that,''
  Nucl.\ Phys.\ B {\bf 834} (2010)
  [arXiv:1001.3360 [hep-ph]].

\end{thebibliography}

\end{document}
